{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Place from\"./Place\";import PopUpForm from\"../forms/PopUpForm\";import NewBookCharacterForm from\"../forms/NewBookCharacterForm\";import{useState,useEffect}from\"react\";import useToggle from\"../hooks/useToggle\";import noteBook from\"../sprites/notes1.png\";import useAxios from\"../hooks/useAxios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PlaceBook=function PlaceBook(_ref){var bookId=_ref.bookId,username=_ref.username;var _useAxios=useAxios([],true),_useAxios2=_slicedToArray(_useAxios,3),reqPlaces=_useAxios2[0],places=_useAxios2[1],setPlaces=_useAxios2[2];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),currPlace=_useState2[0],setCurrPlace=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addForm=_useState4[0],setAddForm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),editForm=_useState6[0],setEditForm=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),addExistingForm=_useState8[0],setAddExistingForm=_useState8[1];useEffect(function(){reqPlaces(\"get\",\"/books/\".concat(bookId,\"/places\"),\"places\");},[]);var showContents=function showContents(){setCurrPlace(null);};var changePlace=function changePlace(num){var newPlace=currPlace?currPlace+num:num;if(newPlace<0)newPlace=null;if(newPlace>places.length)newPlace=0;setCurrPlace(newPlace);};var addPlace=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:reqPlaces(\"post\",\"/books/\".concat(bookId,\"/places\"),\"place\",data);case 1:case\"end\":return _context.stop();}}},_callee);}));return function addPlace(_x){return _ref2.apply(this,arguments);};}();var deletePlace=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(placeId){var res,updatedPlaces;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return reqPlaces(\"delete\",\"/books/\".concat(bookId,\"/places/\").concat(placeId));case 2:res=_context2.sent;if(res.message===\"Deleted!\"){if(currPlace){if(places[currPlace-1].id===placeId){changePlace(-1);}}updatedPlaces=places.filter(function(place){if(place.id!==placeId)return place;});if(!updatedPlaces[0])updatedPlaces=[];setPlaces(function(n){return n=updatedPlaces;});}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function deletePlace(_x2){return _ref3.apply(this,arguments);};}();var editPlace=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(data){var placeId;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:placeId=places[currPlace-1].id;reqPlaces(\"patch\",\"/books/\".concat(bookId,\"/places/\").concat(placeId),\"place\",data);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function editPlace(_x3){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{className:\"CharacterBook_Image\",src:noteBook,alt:\"NoteBook\"}),currPlace&&editForm?/*#__PURE__*/_jsx(PopUpForm,{closeForm:function closeForm(){return setEditForm(false);},submit:editPlace,inputs:[{title:\"Name\",name:\"name\"},{title:\"Description\",name:\"description\"},{title:\"Extra info\",name:\"extra_info\"},{title:\"Public\",name:\"is_public\",type:'checkbox'}],initData:{name:places[currPlace-1].name,description:places[currPlace-1].description,extra_info:places[currPlace-1].extra_info,is_public:places[currPlace-1].is_public},submitText:\"Edit Place\"}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"CharacterBook\",children:[currPlace?null:/*#__PURE__*/_jsx(\"h3\",{children:\"Table of Contents\"}),currPlace&&places.length>0?/*#__PURE__*/_jsx(Place,{handleClick:function handleClick(){return setEditForm(true);},place:places[currPlace-1],deletePlace:deletePlace}):places.map(function(place,inx){return/*#__PURE__*/_jsxs(\"div\",{className:\"CharLink\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return changePlace(inx+1);},name:\"button\",children:place.name}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return deletePlace(place.id);},name:\"button\",children:\"X\"})]},place.id);})]}),addForm?/*#__PURE__*/_jsx(PopUpForm,{closeForm:function closeForm(){return setAddForm(false);},submit:addPlace,inputs:[{title:\"Name\",name:\"name\"},{title:\"Description\",name:\"description\"},{title:\"Extra info\",name:\"extra_info\"},{title:\"Public\",name:\"is_public\",type:'checkbox'}],initData:{name:\"\",description:\"\",extra_info:\"\",is_public:false},submitText:\"Add Place\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"CharacterBook_button\",onClick:function onClick(){return setAddForm(true);},name:\"button\",children:\"New place\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"CharacterBook_Back\",onClick:function onClick(){return changePlace(-1);}}),/*#__PURE__*/_jsx(\"div\",{className:\"CharacterBook_Next\",onClick:function onClick(){return changePlace(1);}})]});};export default PlaceBook;","map":{"version":3,"names":["Place","PopUpForm","NewBookCharacterForm","useState","useEffect","useToggle","noteBook","useAxios","PlaceBook","bookId","username","reqPlaces","places","setPlaces","currPlace","setCurrPlace","addForm","setAddForm","editForm","setEditForm","addExistingForm","setAddExistingForm","showContents","changePlace","num","newPlace","length","addPlace","data","deletePlace","placeId","res","message","id","updatedPlaces","filter","place","n","editPlace","title","name","type","description","extra_info","is_public","map","inx"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/src/notes/PlaceBook.js"],"sourcesContent":["import Place from \"./Place\";\nimport PopUpForm from \"../forms/PopUpForm\";\nimport NewBookCharacterForm from \"../forms/NewBookCharacterForm\";\nimport { useState, useEffect } from \"react\";\nimport useToggle from \"../hooks/useToggle\";\nimport noteBook from \"../sprites/notes1.png\";\nimport useAxios from \"../hooks/useAxios\";\n\nconst PlaceBook = ({ bookId, username }) => {\n  const [reqPlaces, places, setPlaces] = useAxios([],true);\n  const [currPlace, setCurrPlace] = useState(null);\n  const [addForm, setAddForm] = useState(false);\n  const [editForm, setEditForm] = useState(false);\n  const [addExistingForm, setAddExistingForm] = useState(false);\n\n\n  useEffect(() => {\n    reqPlaces(\"get\", `/books/${bookId}/places`, \"places\");\n  }, []);\n\n  const showContents = () => {\n    setCurrPlace(null);\n  };\n\n  const changePlace = (num) => {\n    let newPlace = currPlace ? currPlace + num : num;\n    if (newPlace < 0) newPlace = null;\n    if (newPlace > places.length) newPlace = 0;\n    setCurrPlace(newPlace);\n  };\n\n  const addPlace = async (data) => {\n    reqPlaces(\"post\", `/books/${bookId}/places`, \"place\", data);\n  };\n\n  const deletePlace = async (placeId) => {\n    const res = await reqPlaces(\"delete\", `/books/${bookId}/places/${placeId}`);\n\n    if (res.message === \"Deleted!\") {\n      if (currPlace) {\n        if (places[currPlace - 1].id === placeId) {\n          changePlace(-1);\n        }\n      }\n      let updatedPlaces = places.filter((place) => {\n        if (place.id !== placeId) return place;\n      });\n      if (!updatedPlaces[0]) updatedPlaces = [];\n      setPlaces((n) => (n = updatedPlaces));\n    }\n  };\n\n  const editPlace = async (data) => {\n    const placeId = places[currPlace - 1].id;\n    reqPlaces(\"patch\", `/books/${bookId}/places/${placeId}`, \"place\", data);\n  };\n\n  return (\n    <>\n      <img className=\"CharacterBook_Image\" src={noteBook} alt=\"NoteBook\" />\n\n      {currPlace && editForm ? (\n        <PopUpForm\n          closeForm={() => setEditForm(false)}\n          submit={editPlace}\n          inputs={[\n            { title: \"Name\", name: \"name\" },\n            { title: \"Description\", name: \"description\" },\n            { title: \"Extra info\", name: \"extra_info\" },\n            { title: \"Public\", name: \"is_public\",type:'checkbox'},\n          ]}\n          initData={{\n            name: places[currPlace - 1].name,\n            description: places[currPlace - 1].description,\n            extra_info: places[currPlace - 1].extra_info,\n            is_public: places[currPlace - 1].is_public,\n          }}\n          submitText=\"Edit Place\"\n        />\n      ) : null}\n\n      <div className=\"CharacterBook\">\n        {currPlace ? null : <h3>Table of Contents</h3>}\n\n        {currPlace && places.length > 0 ? (\n          <Place\n            handleClick={() => setEditForm(true)}\n            place={places[currPlace - 1]}\n            deletePlace={deletePlace}\n          />\n        ) : (\n          places.map((place, inx) => (\n            <div className=\"CharLink\" key={place.id}>\n              <button\n                type=\"button\"\n                onClick={() => changePlace(inx + 1)}\n                name=\"button\"\n              >\n                {place.name}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => deletePlace(place.id)}\n                name=\"button\"\n              >\n                X\n              </button>\n            </div>\n          ))\n        )}\n      </div>\n\n      {addForm ? (\n        <PopUpForm\n          closeForm={() => setAddForm(false)}\n          submit={addPlace}\n          inputs={[\n            { title: \"Name\", name: \"name\" },\n            { title: \"Description\", name: \"description\" },\n            { title: \"Extra info\", name: \"extra_info\" },\n            { title: \"Public\", name: \"is_public\",type:'checkbox' },\n          ]}\n          initData={{\n            name: \"\",\n            description: \"\",\n            extra_info: \"\",\n            is_public: false,\n          }}\n          submitText=\"Add Place\"\n        />\n      ) : (\n        <>\n          <button\n            type=\"button\"\n            className=\"CharacterBook_button\"\n            onClick={() => setAddForm(true)}\n            name=\"button\"\n          >\n            New place\n          </button>\n        </>\n      )}\n\n      <div className=\"CharacterBook_Back\" onClick={() => changePlace(-1)}></div>\n      <div className=\"CharacterBook_Next\" onClick={() => changePlace(1)}></div>\n    </>\n  );\n};\nexport default PlaceBook;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}