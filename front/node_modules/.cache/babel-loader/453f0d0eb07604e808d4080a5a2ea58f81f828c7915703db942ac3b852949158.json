{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Character from\"./Character\";import PopUpForm from\"../forms/PopUpForm\";import NewBookCharacterForm from\"../forms/NewBookCharacterForm\";import{useState,useEffect}from\"react\";import useToggle from\"../hooks/useToggle\";import noteBook from\"../sprites/notes1.png\";import useAxios from\"../hooks/useAxios\";import\"../css/CharacterBook.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CharacterBook=function CharacterBook(_ref){var bookId=_ref.bookId,username=_ref.username;var _useAxios=useAxios([],true),_useAxios2=_slicedToArray(_useAxios,3),reqChars=_useAxios2[0],chars=_useAxios2[1],setChars=_useAxios2[2];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),currChar=_useState2[0],setCurrChar=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addForm=_useState4[0],setAddForm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),editForm=_useState6[0],setEditForm=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),addExistingForm=_useState8[0],setAddExistingForm=_useState8[1];useEffect(function(){reqChars(\"get\",\"/books/\".concat(bookId,\"/characters\"),\"characters\");},[]);var showContents=function showContents(){setCurrChar(null);};var changeCharacter=function changeCharacter(num){var newChar=currChar?currChar+num:num;if(newChar<0)newChar=null;if(newChar>chars.length)newChar=0;setCurrChar(newChar);};var addCharacter=function addCharacter(data){reqChars(\"post\",\"/books/\".concat(bookId,\"/characters\"),\"character\",data);};var deleteCharacter=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(characterId){var res,updatedChars;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqChars(\"delete\",\"/books/\".concat(bookId,\"/characters/\").concat(characterId));case 2:res=_context.sent;if(res.message===\"Deleted!\"){if(currChar){if(chars[currChar-1].id===characterId){changeCharacter(-1);}}updatedChars=chars.filter(function(char){if(char.id!==characterId)return char;});if(!updatedChars[0])updatedChars=[];setChars(function(n){return n=updatedChars;});}case 4:case\"end\":return _context.stop();}}},_callee);}));return function deleteCharacter(_x){return _ref2.apply(this,arguments);};}();var editCharacter=function editCharacter(data){var characterId=chars[currChar-1].id;reqChars(\"patch\",\"/books/\".concat(bookId,\"/characters/\").concat(characterId),\"character\",data);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{className:\"CharacterBook_Image\",src:noteBook,alt:\"NoteBook\"}),currChar&&editForm?/*#__PURE__*/_jsx(PopUpForm,{closeForm:function closeForm(){return setEditForm(false);},submit:editCharacter,inputs:[{title:\"Name\",name:\"name\"},{title:\"Birthday\",name:\"birthday\"},{title:\"Description\",name:\"description\"},{title:\"Extra info\",name:\"extra_info\"},{title:\"Backstory\",name:\"story\"},{title:\"Public\",name:\"is_public\",type:'checkbox'}],initData:{name:chars[currChar-1].name,birthday:chars[currChar-1].birthday,description:chars[currChar-1].description,extra_info:chars[currChar-1].extra_info,story:chars[currChar-1].story,is_public:chars[currChar-1].is_public},submitText:\"Edit Character\"}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"CharacterBook\",children:[currChar?null:/*#__PURE__*/_jsx(\"h3\",{children:\"Table of Contents\"}),currChar&&chars.length>0?/*#__PURE__*/_jsx(Character,{handleClick:function handleClick(){return setEditForm(true);},character:chars[currChar-1],deleteChar:deleteCharacter}):chars.map(function(char,inx){return/*#__PURE__*/_jsxs(\"div\",{className:\"CharLink\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return changeCharacter(inx+1);},name:\"button\",children:char.name}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return deleteCharacter(char.id);},name:\"button\",children:\"X\"})]},char.id);})]}),addForm?/*#__PURE__*/_jsx(PopUpForm,{closeForm:function closeForm(){return setAddForm(false);},submit:addCharacter,inputs:[{title:\"Name\",name:\"name\"},{title:\"Birthday\",name:\"birthday\"},{title:\"Description\",name:\"description\"},{title:\"Extra info\",name:\"extra_info\"},{title:\"Backstory\",name:\"story\"},{title:\"Public\",name:\"is_public\",type:'checkbox'}],initData:{name:\"\",birthday:\"\",description:\"\",extra_info:\"\",story:\"\",is_public:false},submitText:\"Add Character\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"CharacterBook_button\",onClick:function onClick(){return setAddForm(true);},name:\"button\",children:\"New character\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"CharacterBook_Back\",onClick:function onClick(){return changeCharacter(-1);}}),/*#__PURE__*/_jsx(\"div\",{className:\"CharacterBook_Next\",onClick:function onClick(){return changeCharacter(1);}})]});};export default CharacterBook;","map":{"version":3,"names":["Character","PopUpForm","NewBookCharacterForm","useState","useEffect","useToggle","noteBook","useAxios","CharacterBook","bookId","username","reqChars","chars","setChars","currChar","setCurrChar","addForm","setAddForm","editForm","setEditForm","addExistingForm","setAddExistingForm","showContents","changeCharacter","num","newChar","length","addCharacter","data","deleteCharacter","characterId","res","message","id","updatedChars","filter","char","n","editCharacter","title","name","type","birthday","description","extra_info","story","is_public","map","inx"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/src/notes/CharacterBook.js"],"sourcesContent":["import Character from \"./Character\";\nimport PopUpForm from \"../forms/PopUpForm\";\nimport NewBookCharacterForm from \"../forms/NewBookCharacterForm\";\nimport { useState, useEffect } from \"react\";\nimport useToggle from \"../hooks/useToggle\";\nimport noteBook from \"../sprites/notes1.png\";\nimport useAxios from \"../hooks/useAxios\";\nimport \"../css/CharacterBook.css\";\nconst CharacterBook = ({ bookId, username }) => {\n  const [reqChars, chars, setChars] = useAxios([],true);\n  const [currChar, setCurrChar] = useState(null);\n  const [addForm, setAddForm] = useState(false);\n  const [editForm, setEditForm] = useState(false);\n  const [addExistingForm, setAddExistingForm] = useState(false);\n\n\n  useEffect(() => {\n    reqChars(\"get\", `/books/${bookId}/characters`, \"characters\");\n  }, []);\n\n  const showContents = () => {\n    setCurrChar(null);\n  };\n\n  const changeCharacter = (num) => {\n    let newChar = currChar ? currChar + num : num;\n    if (newChar < 0) newChar = null;\n    if (newChar > chars.length) newChar = 0;\n    setCurrChar(newChar);\n  };\n\n  const addCharacter = (data) => {\n    reqChars(\"post\", `/books/${bookId}/characters`, \"character\", data);\n  };\n\n  const deleteCharacter = async (characterId) => {\n    const res = await reqChars(\n      \"delete\",\n      `/books/${bookId}/characters/${characterId}`\n    );\n\n    if (res.message === \"Deleted!\") {\n      if (currChar) {\n        if (chars[currChar - 1].id === characterId) {\n          changeCharacter(-1);\n        }\n      }\n      let updatedChars = chars.filter((char) => {\n        if (char.id !== characterId) return char;\n      });\n      if (!updatedChars[0]) updatedChars = [];\n      setChars((n) => (n = updatedChars));\n    }\n  };\n\n  const editCharacter = (data) => {\n    const characterId = chars[currChar - 1].id;\n    reqChars(\n      \"patch\",\n      `/books/${bookId}/characters/${characterId}`,\n      \"character\",\n      data\n    );\n  };\n\n  return (\n    <>\n      <img className=\"CharacterBook_Image\" src={noteBook} alt=\"NoteBook\" />\n\n      {currChar && editForm ? (\n        <PopUpForm\n          closeForm={() => setEditForm(false)}\n          submit={editCharacter}\n          inputs={[\n            { title: \"Name\", name: \"name\" },\n            { title: \"Birthday\", name: \"birthday\" },\n            { title: \"Description\", name: \"description\" },\n            { title: \"Extra info\", name: \"extra_info\" },\n            { title: \"Backstory\", name: \"story\" },\n            { title: \"Public\", name: \"is_public\",type:'checkbox'},\n          ]}\n          initData={{\n            name: chars[currChar - 1].name,\n            birthday: chars[currChar - 1].birthday,\n            description: chars[currChar - 1].description,\n            extra_info: chars[currChar - 1].extra_info,\n            story: chars[currChar - 1].story,\n            is_public: chars[currChar - 1].is_public,\n          }}\n          submitText=\"Edit Character\"\n        />\n      ) : null}\n\n\n\n      <div className=\"CharacterBook\">\n        {currChar ? null : <h3>Table of Contents</h3>}\n\n        {currChar && chars.length > 0 ? (\n        <Character\n            handleClick={() => setEditForm(true)}\n            character={chars[currChar - 1]}\n            deleteChar={deleteCharacter}\n          />\n\n        ) : (\n          chars.map((char, inx) => (\n            <div className=\"CharLink\" key={char.id}>\n              <button\n                type=\"button\"\n                onClick={() => changeCharacter(inx + 1)}\n                name=\"button\"\n              >\n                {char.name}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => deleteCharacter(char.id)}\n                name=\"button\"\n              >\n                X\n              </button>\n            </div>\n          ))\n        )}\n      </div>\n\n      {addForm ? (\n        <PopUpForm\n          closeForm={() => setAddForm(false)}\n          submit={addCharacter}\n          inputs={[\n            { title: \"Name\", name: \"name\" },\n            { title: \"Birthday\", name: \"birthday\" },\n            { title: \"Description\", name: \"description\" },\n            { title: \"Extra info\", name: \"extra_info\" },\n            { title: \"Backstory\", name: \"story\" },\n            { title: \"Public\", name: \"is_public\",type:'checkbox'},\n          ]}\n          initData={{\n            name: \"\",\n            birthday: \"\",\n            description: \"\",\n            extra_info: \"\",\n            story: \"\",\n            is_public: false,\n          }}\n          submitText=\"Add Character\"\n        />\n      ) : (\n        <>\n          <button\n            type=\"button\"\n            className=\"CharacterBook_button\"\n            onClick={() => setAddForm(true)}\n            name=\"button\"\n          >\n            New character\n          </button>\n        </>\n      )}\n\n      <div\n        className=\"CharacterBook_Back\"\n        onClick={() => changeCharacter(-1)}\n      ></div>\n      <div\n        className=\"CharacterBook_Next\"\n        onClick={() => changeCharacter(1)}\n      ></div>\n    </>\n  );\n};\nexport default CharacterBook;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}