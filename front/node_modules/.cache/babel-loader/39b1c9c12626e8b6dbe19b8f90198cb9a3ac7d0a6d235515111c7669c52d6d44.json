{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useParams,useNavigate}from\"react-router-dom\";import{useState,useEffect,useContext}from\"react\";import useAxios from\"../hooks/useAxios\";import NewLibraryBook from\"../forms/NewLibraryBook\";import LibraryBook from\"./LibraryBook\";import Card from\"../pieces/Card\";import{UserContext}from\"../context/context\";//show the library info and all the books in the library\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Library=function Library(){var currentUser=useContext(UserContext);var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var _useAxios=useAxios([]),_useAxios2=_slicedToArray(_useAxios,3),reqBooks=_useAxios2[0],books=_useAxios2[1],setBooks=_useAxios2[2];var _useAxios3=useAxios(null),_useAxios4=_slicedToArray(_useAxios3,2),reqLibrary=_useAxios4[0],library=_useAxios4[1];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),addForm=_useState2[0],setAddForm=_useState2[1];//gets the library and its books\nuseEffect(function(){reqBooks(\"get\",\"/libraries/\".concat(id,\"/books\"),\"books\");reqLibrary(\"get\",\"/libraries/\".concat(id),\"library\");},[]);//adds a book to the library\nvar addBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return reqBooks(\"post\",\"/users/\".concat(library.username,\"/libraries/books\"),\"\",{libraries:[id],books:Object.keys(data)});case 2:_context.next=4;return reqBooks(\"get\",\"/libraries/\".concat(id,\"/books\"),\"books\");case 4:setAddForm(false);case 5:case\"end\":return _context.stop();}},_callee);}));return function addBook(_x){return _ref.apply(this,arguments);};}();//delets a book from the library\nvar deleteBook=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(bookId){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return reqBooks(\"delete\",\"/libraries/\".concat(id,\"/books/\").concat(bookId));case 2:res=_context2.sent;if(res.message===\"Deleted!\")setBooks(function(){return books.filter(function(book){return book.id!=bookId;});});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function deleteBook(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"ListPage\",children:[library?/*#__PURE__*/_jsxs(\"div\",{className:\"Library\",children:[/*#__PURE__*/_jsx(\"h1\",{children:library.name}),/*#__PURE__*/_jsxs(\"p\",{children:[library.description,\", this library is\",\" \",library.is_public?\"public\":\"not public\",\".\",\" \"]})]}):null,books.length>0?/*#__PURE__*/_jsx(\"ol\",{children:books.map(function(book){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(LibraryBook,{book:book,deleteBook:deleteBook})},book.id);})}):null,library?currentUser.username===library.username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Card,{title:\"Add book\",handleClick:function handleClick(){return setAddForm(true);}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return navigate(\"/edit/library/\".concat(id));},name:\"button\",children:\"Edit Library\"})]}):null:null,addForm?/*#__PURE__*/_jsxs(\"div\",{className:\"Library_Add_Book\",children:[/*#__PURE__*/_jsx(NewLibraryBook,{addBook:addBook,username:library.username,title:\"title\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return setAddForm(false);},name:\"button\",children:\"Cancle\"})]}):null]});};export default Library;","map":{"version":3,"names":["useParams","useNavigate","useState","useEffect","useContext","useAxios","NewLibraryBook","LibraryBook","Card","UserContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Library","currentUser","_useParams","id","navigate","_useAxios","_useAxios2","_slicedToArray","reqBooks","books","setBooks","_useAxios3","_useAxios4","reqLibrary","library","_useState","_useState2","addForm","setAddForm","concat","addBook","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","wrap","_callee$","_context","prev","next","username","libraries","Object","keys","stop","_x","apply","arguments","deleteBook","_ref2","_callee2","bookId","res","_callee2$","_context2","sent","message","filter","book","_x2","className","children","name","description","is_public","length","map","title","handleClick","type","onClick"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/front/src/libraries/Library.js"],"sourcesContent":["import { useParams, useNavigate } from \"react-router-dom\";\nimport { useState, useEffect, useContext } from \"react\";\nimport useAxios from \"../hooks/useAxios\";\nimport NewLibraryBook from \"../forms/NewLibraryBook\";\nimport LibraryBook from \"./LibraryBook\";\nimport Card from \"../pieces/Card\";\nimport { UserContext } from \"../context/context\";\n\n//show the library info and all the books in the library\nconst Library = () => {\n  const currentUser = useContext(UserContext);\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const [reqBooks, books, setBooks] = useAxios([]);\n  const [reqLibrary, library] = useAxios(null);\n  const [addForm, setAddForm] = useState(false);\n\n  //gets the library and its books\n  useEffect(() => {\n    reqBooks(\"get\", `/libraries/${id}/books`, \"books\");\n    reqLibrary(\"get\", `/libraries/${id}`, \"library\");\n  }, []);\n\n  //adds a book to the library\n  const addBook = async (data) => {\n     await reqBooks(\n      \"post\",\n      `/users/${library.username}/libraries/books`,\n      \"\",\n      { libraries: [id], books: Object.keys(data) }\n    );\n    await reqBooks(\"get\", `/libraries/${id}/books`, \"books\");\n    setAddForm(false);\n  };\n\n  //delets a book from the library\n  const deleteBook = async (bookId) => {\n    const res = await reqBooks(\"delete\", `/libraries/${id}/books/${bookId}`);\n    if (res.message === \"Deleted!\")\n      setBooks(() => (books.filter((book) => book.id != bookId)));\n  };\n\n  return (\n    <div className=\"ListPage\">\n      {library ? (\n        <div className=\"Library\">\n          <h1>{library.name}</h1>\n          <p>\n            {library.description}, this library is{\" \"}\n            {library.is_public ? \"public\" : \"not public\"}.{\" \"}\n          </p>\n        </div>\n      ) : null}\n      {books.length > 0 ? (\n        <ol>\n          {books.map((book) => (\n            <li key={book.id}>\n              <LibraryBook book={book} deleteBook={deleteBook} />\n            </li>\n          ))}\n        </ol>\n      ) : null}\n\n      {library ? (\n        currentUser.username === library.username ? (\n          <>\n            <Card title=\"Add book\" handleClick={() => setAddForm(true)} />\n            <button\n              type=\"button\"\n              onClick={() => navigate(`/edit/library/${id}`)}\n              name=\"button\"\n            >\n              Edit Library\n            </button>\n          </>\n        ) : null\n      ) : null}\n\n      {addForm ? (\n        <div className=\"Library_Add_Book\">\n          <NewLibraryBook\n            addBook={addBook}\n            username={library.username}\n            title={\"title\"}\n          />\n          <button type=\"button\" onClick={() => setAddForm(false)} name=\"button\">\n            Cancle\n          </button>\n        </div>\n      ) : null}\n    </div>\n  );\n};\nexport default Library;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}