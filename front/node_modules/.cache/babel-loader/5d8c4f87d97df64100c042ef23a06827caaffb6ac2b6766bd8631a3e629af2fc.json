{"ast":null,"code":"var _jsxFileName = \"/Users/rosepowell/Desktop/Book_Writing/book_writing/src/books/Book.js\",\n  _s = $RefreshSig$();\nimport cover from '../sprites/OpenBook1.png';\nimport page from '../sprites/OpenBookPages.png';\nimport { useNavigate } from \"react-router-dom\";\nimport { useState, useEffect, useContext } from 'react';\nimport InputPage from './InputPage';\nimport BookMark from '../books/BookMark';\nimport { UserContext } from \"../context/context\";\nimport Page from './Page';\nimport axios from 'axios';\nimport useAxios from '../hooks/useAxios';\nimport '../css/Book.css';\n\n//keeps track of what page the user is on\n//\n// if they are reading the book gets all the pages for it\n//\n//  if not gets the page by page num when going to the next page\n//   add pages when there are no more Pages\n//   updates the pages when changeing pages and when user presses save\n///////////\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Book = _ref => {\n  _s();\n  let {\n    areReading,\n    bookId,\n    num_of_pages = 2\n  } = _ref;\n  const currentUser = useContext(UserContext);\n  const navigate = useNavigate();\n  const [reqPages, pages, setPages] = useAxios([], areReading);\n  const [reqBook, book] = useAxios(null);\n  const [currPage, setCurrPage] = useState([1, 2]);\n\n  //when the component first renders\n  // gets all the pages in the book, if the user is reading the book\n  useEffect(() => {\n    const getPages = async () => {\n      if (areReading) {\n        const res = await reqPages('get', `/books/${bookId}/pages/all`, 'pages');\n        if (res.data.length <= 0) navigate(`/`); // if its the writer redirect to writing page instead\n        //set message to, There are no pages in this book,   if its the writer, Try writing in it before you read it\n      }\n    };\n\n    getPages();\n  }, []);\n\n  ///when the current page updates gets the current pages, if the user is writing\n  //if there are no pages in the book then it adds pages, if the user is writing\n  //if a user is trying to write on another users book, it redirects them to the page where they can read it instead\n  useEffect(() => {\n    const getPages = async () => {\n      const res = await reqBook('get', `/books/${bookId}`, 'book');\n      if (!areReading && res.data.username === currentUser.username) {\n        const res = await reqPages('get', `/books/${bookId}/pages`, 'pages', {\n          page_nums: currPage\n        }, false);\n        if (res.message === 'Page not found!') {\n          addPages();\n        } else {\n          setPages(n => n = [...res]);\n        }\n      } else if (!areReading && res.data.username !== currentUser.username) {\n        navigate(`/book/${bookId}`);\n        //set message to: Unautrized! Only the writer of the book can edit the book.\n      }\n    };\n\n    getPages();\n  }, [currPage]);\n\n  //go to the next or previous pages\n  //save the current pages\n  const changePage = (num, data) => {\n    if (!areReading) updatePage(data);\n    let newPage = currPage[0] !== null ? currPage[0] + num : num;\n    if (newPage <= 0) newPage = 1;\n    if (newPage >= pages.length && areReading) newPage = pages.length - 1;\n    setCurrPage(n => n = [newPage, newPage + 1]);\n  };\n\n  //gose to a page\n  const goToPage = num => {\n    setCurrPage(n => n = [num, num + 1]);\n  };\n\n  //add new Pages\n  const addPages = async () => {\n    const res = await reqPages('post', `/books/${bookId}/pages`, 'pages', {\n      num_of_pages: 2,\n      page_num: currPage[0]\n    });\n  };\n\n  //saves/updates the current pages\n  const updatePage = async data => {\n    if (currPage[0]) {\n      const pg1 = await reqPages('patch', `/books/${bookId}/pages/${currPage[0]}`, 'page', {\n        text: data.text\n      }, false);\n      const pg2 = await reqPages('patch', `/books/${bookId}/pages/${currPage[1]}`, 'page', {\n        text: data.text2\n      }, false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Book\",\n    children: [pages[0] && !areReading ? /*#__PURE__*/_jsxDEV(BookMark, {\n      bookId: bookId,\n      username: currentUser.username,\n      currPageId: pages[0].id,\n      changePage: goToPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 6\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"img\", {\n      className: \"Book_cover\",\n      src: cover,\n      alt: \"cover\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 3\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      className: \"Book_pages\",\n      src: page,\n      alt: \"pages\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 3\n    }, this), pages.length > 0 ? areReading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Page, {\n        changePage: changePage,\n        page: [pages[currPage[0] - 1], pages[currPage[1] - 1]]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 7\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(InputPage, {\n        changePage: changePage,\n        savePage: updatePage,\n        page: [...pages]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 7\n      }, this)\n    }, void 0, false) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 10\n  }, this);\n};\n_s(Book, \"/CUkUqNUCjW5rk5Q+AF+n+eVieo=\", false, function () {\n  return [useNavigate, useAxios, useAxios];\n});\n_c = Book;\nexport default Book;\nvar _c;\n$RefreshReg$(_c, \"Book\");","map":{"version":3,"names":["cover","page","useNavigate","useState","useEffect","useContext","InputPage","BookMark","UserContext","Page","axios","useAxios","Book","areReading","bookId","num_of_pages","currentUser","navigate","reqPages","pages","setPages","reqBook","book","currPage","setCurrPage","getPages","res","data","length","username","page_nums","message","addPages","n","changePage","num","updatePage","newPage","goToPage","page_num","pg1","text","pg2","text2","id"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/src/books/Book.js"],"sourcesContent":["import cover from '../sprites/OpenBook1.png';\nimport page from '../sprites/OpenBookPages.png';\nimport { useNavigate } from \"react-router-dom\";\nimport {useState, useEffect, useContext} from 'react';\nimport InputPage from './InputPage';\nimport  BookMark from '../books/BookMark';\nimport { UserContext } from \"../context/context\";\nimport Page from './Page';\nimport axios from 'axios';\nimport useAxios from '../hooks/useAxios';\nimport '../css/Book.css';\n\n//keeps track of what page the user is on\n//\n// if they are reading the book gets all the pages for it\n//\n//  if not gets the page by page num when going to the next page\n//   add pages when there are no more Pages\n//   updates the pages when changeing pages and when user presses save\n///////////\nconst Book =({areReading,bookId,num_of_pages=2})=>{\n\n  const currentUser = useContext(UserContext);\n  const navigate = useNavigate();\nconst [reqPages,pages,setPages] = useAxios([],areReading);\nconst [reqBook,book] = useAxios(null);\nconst [currPage,setCurrPage]=useState([1,2]);\n\n\n//when the component first renders\n// gets all the pages in the book, if the user is reading the book\nuseEffect(()=>{\nconst getPages=async()=>{\n  if(areReading){\n      const res = await reqPages('get',`/books/${bookId}/pages/all`,'pages');\n      if(res.data.length <=0) navigate(`/`); // if its the writer redirect to writing page instead\n      //set message to, There are no pages in this book,   if its the writer, Try writing in it before you read it\n  }\n}\ngetPages();\n},[])\n\n\n\n///when the current page updates gets the current pages, if the user is writing\n//if there are no pages in the book then it adds pages, if the user is writing\n//if a user is trying to write on another users book, it redirects them to the page where they can read it instead\nuseEffect(()=>{\nconst getPages=async()=>{\n\n  const res = await reqBook('get',`/books/${bookId}`,'book');\n\n  if(!areReading && res.data.username===currentUser.username){\n    const res = await reqPages('get',`/books/${bookId}/pages`,'pages',{page_nums:currPage},false);\n    if(res.message==='Page not found!'){\n      addPages();\n    }else {\n      setPages((n)=>n=[...res])\n    }\n\n  }\n  else if (!areReading && res.data.username !== currentUser.username) {\nnavigate(`/book/${bookId}`);\n//set message to: Unautrized! Only the writer of the book can edit the book.\n  }\n}\n\ngetPages();\n\n\n},[currPage])\n\n\n//go to the next or previous pages\n//save the current pages\nconst changePage =(num,data)=>{\nif(!areReading) updatePage(data);\nlet newPage = currPage[0]!==null? currPage[0]+num : num;\nif (newPage<=0) newPage = 1;\nif(newPage>=pages.length && areReading) newPage =pages.length-1;\nsetCurrPage((n)=>n=[newPage,newPage+1]);\n}\n\n//gose to a page\nconst goToPage=(num)=>{\nsetCurrPage((n)=>n=[num,num+1]);\n}\n\n\n\n//add new Pages\nconst addPages =async()=>{\nconst res = await reqPages('post',`/books/${bookId}/pages`,'pages',{num_of_pages:2,page_num:currPage[0]});\n}\n\n//saves/updates the current pages\nconst updatePage =async(data)=>{\n  if(currPage[0]){\n  const pg1 = await reqPages('patch',`/books/${bookId}/pages/${currPage[0]}`,'page',{text:data.text},false);\n  const pg2 = await reqPages('patch',`/books/${bookId}/pages/${currPage[1]}`,'page',{text:data.text2},false);\n  }\n\n}\n\n\n  return <div className ='Book'>\n  {\n    pages[0] && !areReading?\n     <BookMark  bookId={bookId} username={currentUser.username} currPageId={pages[0].id} changePage={goToPage}/>\n     :null\n  }\n\n  <img className ='Book_cover' src={cover} alt=\"cover\"/>\n  <img className ='Book_pages' src={page} alt=\"pages\"/>\n\n  {\n     pages.length>0?\n      areReading?\n      <>\n      <Page changePage={changePage} page={[pages[currPage[0]-1],pages[currPage[1]-1]]}/>\n      </>\n      : <>\n      <InputPage changePage={changePage} savePage={updatePage} page={[...pages]}/>\n      </>\n    : null\n  }\n\n\n  </div>\n\n}\n\nexport default Book;\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,0BAA0B;AAC5C,OAAOC,IAAI,MAAM,8BAA8B;AAC/C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAAQC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAO,OAAO;AACrD,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAQC,QAAQ,MAAM,mBAAmB;AACzC,SAASC,WAAW,QAAQ,oBAAoB;AAChD,OAAOC,IAAI,MAAM,QAAQ;AACzB,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,QAAQ,MAAM,mBAAmB;AACxC,OAAO,iBAAiB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA,MAAMC,IAAI,GAAE,QAAsC;EAAA;EAAA,IAArC;IAACC,UAAU;IAACC,MAAM;IAACC,YAAY,GAAC;EAAC,CAAC;EAE7C,MAAMC,WAAW,GAAGX,UAAU,CAACG,WAAW,CAAC;EAC3C,MAAMS,QAAQ,GAAGf,WAAW,EAAE;EAChC,MAAM,CAACgB,QAAQ,EAACC,KAAK,EAACC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,EAAE,EAACE,UAAU,CAAC;EACzD,MAAM,CAACQ,OAAO,EAACC,IAAI,CAAC,GAAGX,QAAQ,CAAC,IAAI,CAAC;EACrC,MAAM,CAACY,QAAQ,EAACC,WAAW,CAAC,GAACrB,QAAQ,CAAC,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC;;EAG5C;EACA;EACAC,SAAS,CAAC,MAAI;IACd,MAAMqB,QAAQ,GAAC,YAAS;MACtB,IAAGZ,UAAU,EAAC;QACV,MAAMa,GAAG,GAAG,MAAMR,QAAQ,CAAC,KAAK,EAAE,UAASJ,MAAO,YAAW,EAAC,OAAO,CAAC;QACtE,IAAGY,GAAG,CAACC,IAAI,CAACC,MAAM,IAAG,CAAC,EAAEX,QAAQ,CAAE,GAAE,CAAC,CAAC,CAAC;QACvC;MACJ;IACF,CAAC;;IACDQ,QAAQ,EAAE;EACV,CAAC,EAAC,EAAE,CAAC;;EAIL;EACA;EACA;EACArB,SAAS,CAAC,MAAI;IACd,MAAMqB,QAAQ,GAAC,YAAS;MAEtB,MAAMC,GAAG,GAAG,MAAML,OAAO,CAAC,KAAK,EAAE,UAASP,MAAO,EAAC,EAAC,MAAM,CAAC;MAE1D,IAAG,CAACD,UAAU,IAAIa,GAAG,CAACC,IAAI,CAACE,QAAQ,KAAGb,WAAW,CAACa,QAAQ,EAAC;QACzD,MAAMH,GAAG,GAAG,MAAMR,QAAQ,CAAC,KAAK,EAAE,UAASJ,MAAO,QAAO,EAAC,OAAO,EAAC;UAACgB,SAAS,EAACP;QAAQ,CAAC,EAAC,KAAK,CAAC;QAC7F,IAAGG,GAAG,CAACK,OAAO,KAAG,iBAAiB,EAAC;UACjCC,QAAQ,EAAE;QACZ,CAAC,MAAK;UACJZ,QAAQ,CAAEa,CAAC,IAAGA,CAAC,GAAC,CAAC,GAAGP,GAAG,CAAC,CAAC;QAC3B;MAEF,CAAC,MACI,IAAI,CAACb,UAAU,IAAIa,GAAG,CAACC,IAAI,CAACE,QAAQ,KAAKb,WAAW,CAACa,QAAQ,EAAE;QACtEZ,QAAQ,CAAE,SAAQH,MAAO,EAAC,CAAC;QAC3B;MACE;IACF,CAAC;;IAEDW,QAAQ,EAAE;EAGV,CAAC,EAAC,CAACF,QAAQ,CAAC,CAAC;;EAGb;EACA;EACA,MAAMW,UAAU,GAAE,CAACC,GAAG,EAACR,IAAI,KAAG;IAC9B,IAAG,CAACd,UAAU,EAAEuB,UAAU,CAACT,IAAI,CAAC;IAChC,IAAIU,OAAO,GAAGd,QAAQ,CAAC,CAAC,CAAC,KAAG,IAAI,GAAEA,QAAQ,CAAC,CAAC,CAAC,GAACY,GAAG,GAAGA,GAAG;IACvD,IAAIE,OAAO,IAAE,CAAC,EAAEA,OAAO,GAAG,CAAC;IAC3B,IAAGA,OAAO,IAAElB,KAAK,CAACS,MAAM,IAAIf,UAAU,EAAEwB,OAAO,GAAElB,KAAK,CAACS,MAAM,GAAC,CAAC;IAC/DJ,WAAW,CAAES,CAAC,IAAGA,CAAC,GAAC,CAACI,OAAO,EAACA,OAAO,GAAC,CAAC,CAAC,CAAC;EACvC,CAAC;;EAED;EACA,MAAMC,QAAQ,GAAEH,GAAG,IAAG;IACtBX,WAAW,CAAES,CAAC,IAAGA,CAAC,GAAC,CAACE,GAAG,EAACA,GAAG,GAAC,CAAC,CAAC,CAAC;EAC/B,CAAC;;EAID;EACA,MAAMH,QAAQ,GAAE,YAAS;IACzB,MAAMN,GAAG,GAAG,MAAMR,QAAQ,CAAC,MAAM,EAAE,UAASJ,MAAO,QAAO,EAAC,OAAO,EAAC;MAACC,YAAY,EAAC,CAAC;MAACwB,QAAQ,EAAChB,QAAQ,CAAC,CAAC;IAAC,CAAC,CAAC;EACzG,CAAC;;EAED;EACA,MAAMa,UAAU,GAAE,MAAMT,IAAI,IAAG;IAC7B,IAAGJ,QAAQ,CAAC,CAAC,CAAC,EAAC;MACf,MAAMiB,GAAG,GAAG,MAAMtB,QAAQ,CAAC,OAAO,EAAE,UAASJ,MAAO,UAASS,QAAQ,CAAC,CAAC,CAAE,EAAC,EAAC,MAAM,EAAC;QAACkB,IAAI,EAACd,IAAI,CAACc;MAAI,CAAC,EAAC,KAAK,CAAC;MACzG,MAAMC,GAAG,GAAG,MAAMxB,QAAQ,CAAC,OAAO,EAAE,UAASJ,MAAO,UAASS,QAAQ,CAAC,CAAC,CAAE,EAAC,EAAC,MAAM,EAAC;QAACkB,IAAI,EAACd,IAAI,CAACgB;MAAK,CAAC,EAAC,KAAK,CAAC;IAC1G;EAEF,CAAC;EAGC,oBAAO;IAAK,SAAS,EAAE,MAAM;IAAA,WAE3BxB,KAAK,CAAC,CAAC,CAAC,IAAI,CAACN,UAAU,gBACtB,QAAC,QAAQ;MAAE,MAAM,EAAEC,MAAO;MAAC,QAAQ,EAAEE,WAAW,CAACa,QAAS;MAAC,UAAU,EAAEV,KAAK,CAAC,CAAC,CAAC,CAACyB,EAAG;MAAC,UAAU,EAAEN;IAAS;MAAA;MAAA;MAAA;IAAA,QAAE,GAC1G,IAAI,eAGR;MAAK,SAAS,EAAE,YAAY;MAAC,GAAG,EAAEtC,KAAM;MAAC,GAAG,EAAC;IAAO;MAAA;MAAA;MAAA;IAAA,QAAE,eACtD;MAAK,SAAS,EAAE,YAAY;MAAC,GAAG,EAAEC,IAAK;MAAC,GAAG,EAAC;IAAO;MAAA;MAAA;MAAA;IAAA,QAAE,EAGlDkB,KAAK,CAACS,MAAM,GAAC,CAAC,GACbf,UAAU,gBACV;MAAA,uBACA,QAAC,IAAI;QAAC,UAAU,EAAEqB,UAAW;QAAC,IAAI,EAAE,CAACf,KAAK,CAACI,QAAQ,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC,EAACJ,KAAK,CAACI,QAAQ,CAAC,CAAC,CAAC,GAAC,CAAC,CAAC;MAAE;QAAA;QAAA;QAAA;MAAA;IAAE,iBAC/E,gBACD;MAAA,uBACF,QAAC,SAAS;QAAC,UAAU,EAAEW,UAAW;QAAC,QAAQ,EAAEE,UAAW;QAAC,IAAI,EAAE,CAAC,GAAGjB,KAAK;MAAE;QAAA;QAAA;QAAA;MAAA;IAAE,iBACzE,GACH,IAAI;EAAA;IAAA;IAAA;IAAA;EAAA,QAIF;AAER,CAAC;AAAA,GA9GKP,IAAI;EAAA,QAGSV,WAAW,EACIS,QAAQ,EACnBA,QAAQ;AAAA;AAAA,KALzBC,IAAI;AAgHV,eAAeA,IAAI;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}