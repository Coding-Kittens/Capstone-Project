{"ast":null,"code":"var _jsxFileName = \"/Users/rosepowell/Desktop/desktop stuff/myprojects/Book_Writing/book_writing/front/src/books/Book.js\",\n  _s = $RefreshSig$();\nimport { useNavigate } from \"react-router-dom\";\nimport { useState, useEffect, useContext } from \"react\";\nimport InputPage from \"./InputPage\";\nimport BookMark from \"../books/BookMark\";\nimport { UserContext } from \"../context/context\";\n//MessageContext\nimport Page from \"./Page\";\nimport useAxios from \"../hooks/useAxios\";\nimport \"../css/Book.css\";\n\n//keeps track of what page the user is on\n//\n// if they are reading the book gets all the pages for it\n//\n//  if not gets the page by page num when going to the next page\n//   add pages when there are no more Pages\n//   updates the pages when changeing pages and when user presses save\n///////////\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Book = _ref => {\n  _s();\n  let {\n    areReading,\n    bookId,\n    cover_color,\n    theme\n  } = _ref;\n  const currentUser = useContext(UserContext);\n  // const setMessage = useContext(MessageContext).setMessage;\n  const navigate = useNavigate();\n  const [reqPages, pages, setPages] = useAxios([], areReading);\n  const [reqBook] = useAxios(null);\n  const [currPage, setCurrPage] = useState([1, 2]);\n\n  //when the component first renders\n  // gets all the pages in the book, if the user is reading the book\n  useEffect(() => {\n    const getPages = async () => {\n      if (areReading) {\n        await reqPages(\"get\", `/books/${bookId}/all/pages`, \"pages\");\n      }\n    };\n    getPages();\n  }, []);\n\n  ///when the current page updates gets the current pages, if the user is writing\n  //if there are no pages in the book then it adds pages, if the user is writing\n  //if a user is trying to write on another users book, it redirects them to the page where they can read it instead\n  useEffect(() => {\n    const getPages = async () => {\n      const res = await reqBook(\"get\", `/books/${bookId}`, \"book\");\n      if (!areReading && res.data.username === currentUser.username) {\n        const res = await reqPages(\"get\", `/books/${bookId}/pages`, \"pages\", {\n          page_nums: currPage\n        }, false);\n        if (res.message === \"Page not found!\") {\n          addPages();\n        } else {\n          setPages(() => [...res]);\n        }\n        console.log(res);\n      } else if (!areReading && res.data.username !== currentUser.username) {\n        navigate(`/book/${bookId}`);\n        //set message to: Unautrized! Only the writer of the book can edit the book.\n      }\n    };\n\n    getPages();\n  }, [currPage]);\n\n  //go to the next or previous pages\n  //save the current pages\n  const changePage = (num, data) => {\n    if (!areReading) updatePage(data);\n    let newPage = currPage[0] !== null ? currPage[0] + num : num;\n    if (newPage <= 0) newPage = 1;\n    if (newPage >= pages.length && areReading) newPage = pages.length - 1;\n    setCurrPage(() => [newPage, newPage + 1]);\n  };\n\n  //gose to a page\n  const goToPage = num => {\n    setCurrPage(() => [num, num + 1]);\n  };\n\n  //add new Pages\n  const addPages = async () => {\n    await reqPages(\"post\", `/books/${bookId}/pages`, \"pages\", {\n      num_of_pages: 2,\n      page_num: currPage[0]\n    });\n  };\n\n  //saves/updates the current pages\n  const updatePage = async data => {\n    if (currPage[0]) {\n      await reqPages(\"patch\", `/books/${bookId}/pages/${currPage[0]}`, \"page\", {\n        text: data.text\n      }, false);\n      await reqPages(\"patch\", `/books/${bookId}/pages/${currPage[1]}`, \"page\", {\n        text: data.text2\n      }, false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Book\",\n    children: [pages[0] && !areReading ? /*#__PURE__*/_jsxDEV(BookMark, {\n      bookId: bookId,\n      username: currentUser.username,\n      currPageId: pages[0].id,\n      changePage: goToPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 9\n    }, this) : null, /*#__PURE__*/_jsxDEV(\"img\", {\n      className: areReading ? \"Book_cover_Reading\" : \"Book_cover\",\n      src: theme.openBookImg,\n      alt: \"cover\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      style: {\n        backgroundColor: cover_color\n      },\n      className: `image_color ${areReading ? \"Book_pages_Reading\" : \"Book_pages\"}`,\n      src: theme.overOpenImg,\n      alt: \"pages\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }, this), pages.length > 0 ? areReading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(Page, {\n        changePage: changePage,\n        page: [pages[currPage[0] - 1], pages[currPage[1] - 1]]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }, this)\n    }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(InputPage, {\n        changePage: changePage,\n        savePage: updatePage,\n        page: [...pages]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }, this)\n    }, void 0, false) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 117,\n    columnNumber: 5\n  }, this);\n};\n_s(Book, \"PMMmU39IZewbhXnuDh6OxpAsY+g=\", false, function () {\n  return [useNavigate, useAxios, useAxios];\n});\n_c = Book;\nexport default Book;\nvar _c;\n$RefreshReg$(_c, \"Book\");","map":{"version":3,"names":["useNavigate","useState","useEffect","useContext","InputPage","BookMark","UserContext","Page","useAxios","jsxDEV","_jsxDEV","Fragment","_Fragment","Book","_ref","_s","areReading","bookId","cover_color","theme","currentUser","navigate","reqPages","pages","setPages","reqBook","currPage","setCurrPage","getPages","res","data","username","page_nums","message","addPages","console","log","changePage","num","updatePage","newPage","length","goToPage","num_of_pages","page_num","text","text2","className","children","currPageId","id","fileName","_jsxFileName","lineNumber","columnNumber","src","openBookImg","alt","style","backgroundColor","overOpenImg","page","savePage","_c","$RefreshReg$"],"sources":["/Users/rosepowell/Desktop/desktop stuff/myprojects/Book_Writing/book_writing/front/src/books/Book.js"],"sourcesContent":["import { useNavigate } from \"react-router-dom\";\nimport { useState, useEffect, useContext } from \"react\";\nimport InputPage from \"./InputPage\";\nimport BookMark from \"../books/BookMark\";\nimport { UserContext } from \"../context/context\";\n//MessageContext\nimport Page from \"./Page\";\n\nimport useAxios from \"../hooks/useAxios\";\nimport \"../css/Book.css\";\n\n//keeps track of what page the user is on\n//\n// if they are reading the book gets all the pages for it\n//\n//  if not gets the page by page num when going to the next page\n//   add pages when there are no more Pages\n//   updates the pages when changeing pages and when user presses save\n///////////\nconst Book = ({ areReading, bookId, cover_color,theme}) => {\n  const currentUser = useContext(UserContext);\n  // const setMessage = useContext(MessageContext).setMessage;\n  const navigate = useNavigate();\n  const [reqPages, pages, setPages] = useAxios([], areReading);\n  const [reqBook] = useAxios(null);\n  const [currPage, setCurrPage] = useState([1, 2]);\n\n  //when the component first renders\n  // gets all the pages in the book, if the user is reading the book\n  useEffect(() => {\n    const getPages = async () => {\n      if (areReading) {\n        await reqPages(\n          \"get\",\n          `/books/${bookId}/all/pages`,\n          \"pages\"\n        );\n      }\n    };\n    getPages();\n  }, []);\n\n  ///when the current page updates gets the current pages, if the user is writing\n  //if there are no pages in the book then it adds pages, if the user is writing\n  //if a user is trying to write on another users book, it redirects them to the page where they can read it instead\n  useEffect(() => {\n    const getPages = async () => {\n      const res = await reqBook(\"get\", `/books/${bookId}`, \"book\");\n\n      if (!areReading && res.data.username === currentUser.username) {\n        const res = await reqPages(\n          \"get\",\n          `/books/${bookId}/pages`,\n          \"pages\",\n          { page_nums: currPage },\n          false\n        );\n        if (res.message === \"Page not found!\") {\n          addPages();\n        } else {\n          setPages(() => ( [...res]));\n        }\n        console.log(res);\n      } else if (!areReading && res.data.username !== currentUser.username) {\n        navigate(`/book/${bookId}`);\n        //set message to: Unautrized! Only the writer of the book can edit the book.\n      }\n    };\n\n    getPages();\n  }, [currPage]);\n\n  //go to the next or previous pages\n  //save the current pages\n  const changePage = (num, data) => {\n    if (!areReading) updatePage(data);\n    let newPage = currPage[0] !== null ? currPage[0] + num : num;\n    if (newPage <= 0) newPage = 1;\n    if (newPage >= pages.length && areReading) newPage = pages.length - 1;\n    setCurrPage(() => ([newPage, newPage + 1]));\n  };\n\n  //gose to a page\n  const goToPage = (num) => {\n    setCurrPage(() => ([num, num + 1]));\n  };\n\n  //add new Pages\n  const addPages = async () => {\n    await reqPages(\"post\", `/books/${bookId}/pages`, \"pages\", {\n      num_of_pages: 2,\n      page_num: currPage[0],\n    });\n  };\n\n  //saves/updates the current pages\n  const updatePage = async (data) => {\n    if (currPage[0]) {\n      await reqPages(\n        \"patch\",\n        `/books/${bookId}/pages/${currPage[0]}`,\n        \"page\",\n        { text: data.text },\n        false\n      );\n       await reqPages(\n        \"patch\",\n        `/books/${bookId}/pages/${currPage[1]}`,\n        \"page\",\n        { text: data.text2 },\n        false\n      );\n    }\n  };\n\n  return (\n    <div className=\"Book\">\n      {pages[0] && !areReading ? (\n        <BookMark\n          bookId={bookId}\n          username={currentUser.username}\n          currPageId={pages[0].id}\n          changePage={goToPage}\n        />\n      ) : null}\n\n      <img\n        className={areReading ? \"Book_cover_Reading\" : \"Book_cover\"}\n        src={theme.openBookImg}\n        alt=\"cover\"\n      />\n      <img\n        style={{ backgroundColor: cover_color}}\n        className={`image_color ${areReading ? \"Book_pages_Reading\" : \"Book_pages\"}`}\n        src={theme.overOpenImg}\n        alt=\"pages\"\n      />\n\n      {pages.length > 0 ? (\n        areReading ? (\n          <>\n            <Page\n              changePage={changePage}\n              page={[pages[currPage[0] - 1], pages[currPage[1] - 1]]}\n            />\n          </>\n        ) : (\n          <>\n            <InputPage\n              changePage={changePage}\n              savePage={updatePage}\n              page={[...pages]}\n            />\n          </>\n        )\n      ) : null}\n    </div>\n  );\n};\n\nexport default Book;\n"],"mappings":";;AAAA,SAASA,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AACvD,OAAOC,SAAS,MAAM,aAAa;AACnC,OAAOC,QAAQ,MAAM,mBAAmB;AACxC,SAASC,WAAW,QAAQ,oBAAoB;AAChD;AACA,OAAOC,IAAI,MAAM,QAAQ;AAEzB,OAAOC,QAAQ,MAAM,mBAAmB;AACxC,OAAO,iBAAiB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,IAAI,GAAGC,IAAA,IAA8C;EAAAC,EAAA;EAAA,IAA7C;IAAEC,UAAU;IAAEC,MAAM;IAAEC,WAAW;IAACC;EAAK,CAAC,GAAAL,IAAA;EACpD,MAAMM,WAAW,GAAGjB,UAAU,CAACG,WAAW,CAAC;EAC3C;EACA,MAAMe,QAAQ,GAAGrB,WAAW,EAAE;EAC9B,MAAM,CAACsB,QAAQ,EAAEC,KAAK,EAAEC,QAAQ,CAAC,GAAGhB,QAAQ,CAAC,EAAE,EAAEQ,UAAU,CAAC;EAC5D,MAAM,CAACS,OAAO,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EAChC,MAAM,CAACkB,QAAQ,EAAEC,WAAW,CAAC,GAAG1B,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;EAEhD;EACA;EACAC,SAAS,CAAC,MAAM;IACd,MAAM0B,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,IAAIZ,UAAU,EAAE;QACd,MAAMM,QAAQ,CACZ,KAAK,EACJ,UAASL,MAAO,YAAW,EAC5B,OAAO,CACR;MACH;IACF,CAAC;IACDW,QAAQ,EAAE;EACZ,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA;EACA;EACA1B,SAAS,CAAC,MAAM;IACd,MAAM0B,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3B,MAAMC,GAAG,GAAG,MAAMJ,OAAO,CAAC,KAAK,EAAG,UAASR,MAAO,EAAC,EAAE,MAAM,CAAC;MAE5D,IAAI,CAACD,UAAU,IAAIa,GAAG,CAACC,IAAI,CAACC,QAAQ,KAAKX,WAAW,CAACW,QAAQ,EAAE;QAC7D,MAAMF,GAAG,GAAG,MAAMP,QAAQ,CACxB,KAAK,EACJ,UAASL,MAAO,QAAO,EACxB,OAAO,EACP;UAAEe,SAAS,EAAEN;QAAS,CAAC,EACvB,KAAK,CACN;QACD,IAAIG,GAAG,CAACI,OAAO,KAAK,iBAAiB,EAAE;UACrCC,QAAQ,EAAE;QACZ,CAAC,MAAM;UACLV,QAAQ,CAAC,MAAQ,CAAC,GAAGK,GAAG,CAAE,CAAC;QAC7B;QACAM,OAAO,CAACC,GAAG,CAACP,GAAG,CAAC;MAClB,CAAC,MAAM,IAAI,CAACb,UAAU,IAAIa,GAAG,CAACC,IAAI,CAACC,QAAQ,KAAKX,WAAW,CAACW,QAAQ,EAAE;QACpEV,QAAQ,CAAE,SAAQJ,MAAO,EAAC,CAAC;QAC3B;MACF;IACF,CAAC;;IAEDW,QAAQ,EAAE;EACZ,CAAC,EAAE,CAACF,QAAQ,CAAC,CAAC;;EAEd;EACA;EACA,MAAMW,UAAU,GAAGA,CAACC,GAAG,EAAER,IAAI,KAAK;IAChC,IAAI,CAACd,UAAU,EAAEuB,UAAU,CAACT,IAAI,CAAC;IACjC,IAAIU,OAAO,GAAGd,QAAQ,CAAC,CAAC,CAAC,KAAK,IAAI,GAAGA,QAAQ,CAAC,CAAC,CAAC,GAAGY,GAAG,GAAGA,GAAG;IAC5D,IAAIE,OAAO,IAAI,CAAC,EAAEA,OAAO,GAAG,CAAC;IAC7B,IAAIA,OAAO,IAAIjB,KAAK,CAACkB,MAAM,IAAIzB,UAAU,EAAEwB,OAAO,GAAGjB,KAAK,CAACkB,MAAM,GAAG,CAAC;IACrEd,WAAW,CAAC,MAAO,CAACa,OAAO,EAAEA,OAAO,GAAG,CAAC,CAAE,CAAC;EAC7C,CAAC;;EAED;EACA,MAAME,QAAQ,GAAIJ,GAAG,IAAK;IACxBX,WAAW,CAAC,MAAO,CAACW,GAAG,EAAEA,GAAG,GAAG,CAAC,CAAE,CAAC;EACrC,CAAC;;EAED;EACA,MAAMJ,QAAQ,GAAG,MAAAA,CAAA,KAAY;IAC3B,MAAMZ,QAAQ,CAAC,MAAM,EAAG,UAASL,MAAO,QAAO,EAAE,OAAO,EAAE;MACxD0B,YAAY,EAAE,CAAC;MACfC,QAAQ,EAAElB,QAAQ,CAAC,CAAC;IACtB,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMa,UAAU,GAAG,MAAOT,IAAI,IAAK;IACjC,IAAIJ,QAAQ,CAAC,CAAC,CAAC,EAAE;MACf,MAAMJ,QAAQ,CACZ,OAAO,EACN,UAASL,MAAO,UAASS,QAAQ,CAAC,CAAC,CAAE,EAAC,EACvC,MAAM,EACN;QAAEmB,IAAI,EAAEf,IAAI,CAACe;MAAK,CAAC,EACnB,KAAK,CACN;MACA,MAAMvB,QAAQ,CACb,OAAO,EACN,UAASL,MAAO,UAASS,QAAQ,CAAC,CAAC,CAAE,EAAC,EACvC,MAAM,EACN;QAAEmB,IAAI,EAAEf,IAAI,CAACgB;MAAM,CAAC,EACpB,KAAK,CACN;IACH;EACF,CAAC;EAED,oBACEpC,OAAA;IAAKqC,SAAS,EAAC,MAAM;IAAAC,QAAA,GAClBzB,KAAK,CAAC,CAAC,CAAC,IAAI,CAACP,UAAU,gBACtBN,OAAA,CAACL,QAAQ;MACPY,MAAM,EAAEA,MAAO;MACfc,QAAQ,EAAEX,WAAW,CAACW,QAAS;MAC/BkB,UAAU,EAAE1B,KAAK,CAAC,CAAC,CAAC,CAAC2B,EAAG;MACxBb,UAAU,EAAEK;IAAS;MAAAS,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACrB,GACA,IAAI,eAER5C,OAAA;MACEqC,SAAS,EAAE/B,UAAU,GAAG,oBAAoB,GAAG,YAAa;MAC5DuC,GAAG,EAAEpC,KAAK,CAACqC,WAAY;MACvBC,GAAG,EAAC;IAAO;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACX,eACF5C,OAAA;MACEgD,KAAK,EAAE;QAAEC,eAAe,EAAEzC;MAAW,CAAE;MACvC6B,SAAS,EAAG,eAAc/B,UAAU,GAAG,oBAAoB,GAAG,YAAa,EAAE;MAC7EuC,GAAG,EAAEpC,KAAK,CAACyC,WAAY;MACvBH,GAAG,EAAC;IAAO;MAAAN,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACX,EAED/B,KAAK,CAACkB,MAAM,GAAG,CAAC,GACfzB,UAAU,gBACRN,OAAA,CAAAE,SAAA;MAAAoC,QAAA,eACEtC,OAAA,CAACH,IAAI;QACH8B,UAAU,EAAEA,UAAW;QACvBwB,IAAI,EAAE,CAACtC,KAAK,CAACG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,EAAEH,KAAK,CAACG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;MAAE;QAAAyB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IACvD,iBACD,gBAEH5C,OAAA,CAAAE,SAAA;MAAAoC,QAAA,eACEtC,OAAA,CAACN,SAAS;QACRiC,UAAU,EAAEA,UAAW;QACvByB,QAAQ,EAAEvB,UAAW;QACrBsB,IAAI,EAAE,CAAC,GAAGtC,KAAK;MAAE;QAAA4B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA;IACjB,iBAEL,GACC,IAAI;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACJ;AAEV,CAAC;AAACvC,EAAA,CA3IIF,IAAI;EAAA,QAGSb,WAAW,EACQQ,QAAQ,EAC1BA,QAAQ;AAAA;AAAAuD,EAAA,GALtBlD,IAAI;AA6IV,eAAeA,IAAI;AAAC,IAAAkD,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}