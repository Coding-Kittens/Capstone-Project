{"ast":null,"code":"import _objectSpread from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import PopUpForm from\"../forms/PopUpForm\";import{useState,useEffect}from\"react\";import useToggle from\"../hooks/useToggle\";import bookmark from\"../sprites/bookMark.png\";import useAxios from\"../hooks/useAxios\";import\"../css/CharacterBook.css\";import NotePage from\"../notes/NotePage\";import Tab from\"./Tab\";import'../css/BookMark.css';///shows all the bookmarks for a book and lets you add a new one\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BookMark=function BookMark(_ref){var bookId=_ref.bookId,username=_ref.username,currPageId=_ref.currPageId,changePage=_ref.changePage;var _useAxios=useAxios([],true),_useAxios2=_slicedToArray(_useAxios,3),reqNotes=_useAxios2[0],notes=_useAxios2[1],setNotes=_useAxios2[2];var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currNote=_useState2[0],setCurrNote=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),addForm=_useState4[0],setAddForm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),addExistingForm=_useState6[0],setAddExistingForm=_useState6[1];useEffect(function(){reqNotes('get',\"/bookmarks/\".concat(bookId),'bookmarks');},[]);var addNote=function addNote(data,pageId){reqNotes('post',\"/bookmarks/\".concat(bookId,\"/\").concat(pageId),'bookmark',data);};var deleteNote=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(pageId){var res,updatedNotes;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqNotes('delete',\"/bookmarks/\".concat(bookId,\"/\").concat(pageId));case 2:res=_context.sent;if(res.message===\"Deleted!\"){updatedNotes=notes.filter(function(note){if(note.page_id!==pageId)return note;});if(!updatedNotes[0])updatedNotes=[];setNotes(function(n){return n=updatedNotes;});}case 4:case\"end\":return _context.stop();}}},_callee);}));return function deleteNote(_x){return _ref2.apply(this,arguments);};}();var editNote=function editNote(data,pageId){reqNotes('patch',\"/bookmarks/\".concat(bookId,\"/\").concat(pageId),'bookmark',_objectSpread(_objectSpread({},data),{},{page_id:currPageId,book_id:bookId}));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{className:\"BookMark_Image\",src:bookmark,alt:\"bookmark\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"BookMark\",children:[notes.length>0&&currPageId?notes.map(function(note){return/*#__PURE__*/_jsx(Tab,{info:note,page_id:currPageId,handleClick:function handleClick(){return changePage(note.page_num);},editTab:editNote,deleteTab:deleteNote});}):null,addForm?/*#__PURE__*/_jsx(PopUpForm,{closeForm:function closeForm(){return setAddForm(false);},submit:function submit(data){return addNote(data,currPageId);},inputs:[{name:'text',title:'Note'}],initData:{text:\"\"},submitText:\"Add\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"BookMark_button\",onClick:function onClick(){return setAddForm(true);},name:\"button\",children:\"New Bookmark\"})})]})]});};export default BookMark;","map":{"version":3,"names":["PopUpForm","useState","useEffect","useToggle","bookmark","useAxios","NotePage","Tab","BookMark","bookId","username","currPageId","changePage","reqNotes","notes","setNotes","currNote","setCurrNote","addForm","setAddForm","addExistingForm","setAddExistingForm","addNote","data","pageId","deleteNote","res","message","updatedNotes","filter","note","page_id","n","editNote","book_id","length","map","page_num","name","title","text"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/src/books/BookMark.js"],"sourcesContent":["import PopUpForm from \"../forms/PopUpForm\";\nimport { useState, useEffect } from \"react\";\nimport useToggle from \"../hooks/useToggle\";\nimport bookmark from \"../sprites/bookMark.png\";\nimport useAxios from \"../hooks/useAxios\";\nimport \"../css/CharacterBook.css\";\nimport NotePage from \"../notes/NotePage\";\nimport Tab from \"./Tab\";\nimport '../css/BookMark.css';\n\n///shows all the bookmarks for a book and lets you add a new one\nconst BookMark = ({ bookId, username, currPageId, changePage }) => {\n  const [reqNotes,notes, setNotes] = useAxios([],true);\n  const [currNote, setCurrNote] = useState(1);\n  const [addForm, setAddForm] = useState(false);\n\n  const [addExistingForm, setAddExistingForm] = useState(false);\n\n  useEffect(() => {\n    reqNotes('get',`/bookmarks/${bookId}`,'bookmarks');\n  }, []);\n\n\n  const addNote = (data, pageId) => {\n    reqNotes('post',`/bookmarks/${bookId}/${pageId}`,'bookmark',data);\n  };\n\n  const deleteNote = async (pageId) => {\n    const res = await reqNotes('delete',`/bookmarks/${bookId}/${pageId}`)\n    if (res.message === \"Deleted!\") {\n      let updatedNotes = notes.filter((note) => {\n        if (note.page_id !== pageId) return note;\n      });\n      if (!updatedNotes[0]) updatedNotes = [];\n      setNotes((n) => (n = updatedNotes));\n    }\n  };\n\n  const editNote = (data, pageId) => {\n    reqNotes('patch',`/bookmarks/${bookId}/${pageId}`,'bookmark',{\n      ...data,\n      page_id: currPageId,\n      book_id: bookId,\n    })\n  };\n\n  return (\n    <>\n      <img className=\"BookMark_Image\" src={bookmark} alt=\"bookmark\" />\n\n      <div className=\"BookMark\">\n        {notes.length > 0 && currPageId\n          ? notes.map((note) => (\n              <Tab\n                info={note}\n                page_id={currPageId}\n                handleClick={() => changePage(note.page_num)}\n                editTab={editNote}\n                deleteTab={deleteNote}\n              />\n            ))\n          : null}\n\n          {addForm ? (\n            <PopUpForm\n              closeForm={() => setAddForm(false)}\n              submit={(data) => addNote(data, currPageId)}\n              inputs={[{name:'text',title:'Note'}]}\n              initData={{\n                text: \"\",\n              }}\n              submitText=\"Add\"\n            />\n          ) : (\n            <>\n              <button\n                type=\"button\"\n                className=\"BookMark_button\"\n                onClick={() => setAddForm(true)}\n                name=\"button\"\n              >\n                New Bookmark\n              </button>\n            </>\n          )}\n      </div>\n\n\n    </>\n  );\n};\nexport default BookMark;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}