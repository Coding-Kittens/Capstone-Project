{"ast":null,"code":"import _regeneratorRuntime from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/rosepowell/Desktop/Book_Writing/book_writing/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useParams,useNavigate}from\"react-router-dom\";import{useState,useEffect,useContext}from'react';import useAxios from'../hooks/useAxios';import NewLibraryBook from'../forms/NewLibraryBook';import LibraryBook from'./LibraryBook';import Card from'../pieces/Card';import{UserContext}from\"../context/context\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Library=function Library(){var currentUser=useContext(UserContext);var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var _useAxios=useAxios([]),_useAxios2=_slicedToArray(_useAxios,3),reqBooks=_useAxios2[0],books=_useAxios2[1],setBooks=_useAxios2[2];var _useAxios3=useAxios(null),_useAxios4=_slicedToArray(_useAxios3,3),reqLibrary=_useAxios4[0],library=_useAxios4[1],setLibrary=_useAxios4[2];var _useState=useState(false),_useState2=_slicedToArray(_useState,2),addForm=_useState2[0],setAddForm=_useState2[1];useEffect(function(){reqBooks('get',\"/libraries/\".concat(id,\"/books\"),'books');reqLibrary('get',\"/libraries/\".concat(id),'library');},[]);var addBook=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return reqBooks('post',\"/users/\".concat(library.username,\"/libraries/books\"),'',{libraries:[id],books:Object.keys(data)});case 2:res=_context.sent;_context.next=5;return reqBooks('get',\"/libraries/\".concat(id,\"/books\"),'books');case 5:setAddForm(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function addBook(_x){return _ref.apply(this,arguments);};}();var deleteBook=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(bookId){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return reqBooks('delete',\"/libraries/\".concat(id,\"/books/\").concat(bookId));case 2:res=_context2.sent;if(res.message==='Deleted!')setBooks(function(n){return n=books.filter(function(book){return book.id!=bookId;});});case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteBook(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"ListPage\",children:[library?/*#__PURE__*/_jsxs(\"div\",{className:\"Library\",children:[/*#__PURE__*/_jsx(\"h1\",{children:library.name}),/*#__PURE__*/_jsxs(\"p\",{children:[library.description,\", this library is \",library.is_public?'public':\"not public\",\". \"]})]}):null,books.length>0?/*#__PURE__*/_jsx(\"ol\",{children:books.map(function(book){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(LibraryBook,{book:book,deleteBook:deleteBook})});})}):null,library?currentUser.username===library.username?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Card,{title:\"Add book\",handleClick:function handleClick(){return setAddForm(true);}}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return navigate(\"/edit/library/\".concat(id));},name:\"button\",children:\"Edit Library\"})]}):null:null,addForm?/*#__PURE__*/_jsxs(\"div\",{className:\"Library_Add_Book\",children:[/*#__PURE__*/_jsx(NewLibraryBook,{addBook:addBook,username:library.username,title:'title'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(){return setAddForm(false);},name:\"button\",children:\"Cancle\"})]}):null]});};export default Library;","map":{"version":3,"names":["useParams","useNavigate","useState","useEffect","useContext","useAxios","NewLibraryBook","LibraryBook","Card","UserContext","Library","currentUser","id","navigate","reqBooks","books","setBooks","reqLibrary","library","setLibrary","addForm","setAddForm","addBook","data","username","libraries","Object","keys","res","deleteBook","bookId","message","n","filter","book","name","description","is_public","length","map"],"sources":["/Users/rosepowell/Desktop/Book_Writing/book_writing/src/libraries/Library.js"],"sourcesContent":["import { useParams, useNavigate } from \"react-router-dom\";\nimport {useState,useEffect,useContext} from 'react';\nimport useAxios from '../hooks/useAxios';\nimport NewLibraryBook from '../forms/NewLibraryBook';\nimport LibraryBook from './LibraryBook';\nimport Card from '../pieces/Card';\nimport { UserContext } from \"../context/context\";\nconst Library =()=>{\n  const currentUser = useContext(UserContext);\nconst { id } = useParams();\n  const navigate = useNavigate();\nconst [reqBooks,books,setBooks] = useAxios([]);\nconst [reqLibrary,library,setLibrary] = useAxios(null);\nconst [addForm,setAddForm] = useState(false);\n\n\nuseEffect(()=>{\n  reqBooks('get',`/libraries/${id}/books`,'books');\n  reqLibrary('get',`/libraries/${id}`,'library');\n},[])\n\n\nconst addBook=async(data)=>{\nconst res = await reqBooks('post',`/users/${library.username}/libraries/books`,'',{libraries:[id],books:Object.keys(data)})\nawait reqBooks('get',`/libraries/${id}/books`,'books');\nsetAddForm(false)\n}\n\nconst deleteBook=async(bookId)=>{\nconst res = await reqBooks('delete',`/libraries/${id}/books/${bookId}`);\nif(res.message === 'Deleted!')setBooks((n)=>n= books.filter(book=> book.id !=bookId));\n}\n\n\n\n  return<div className=\"ListPage\">\n  {library?\n    <div className='Library'>\n    <h1>{library.name}</h1>\n  <p>{library.description}, this library is {library.is_public? 'public': \"not public\"}. </p>\n  </div>\n  :\n  null\n}\n{books.length>0?\n  <ol>\n    {books.map(book => <li><LibraryBook book={book} deleteBook={deleteBook}/></li>)}\n  </ol>\n:\nnull\n}\n\n{\nlibrary?\ncurrentUser.username===library.username?\n  <>\n  <Card title='Add book' handleClick={()=>setAddForm(true)}/>\n  <button type=\"button\" onClick={()=>navigate(`/edit/library/${id}`)} name=\"button\">Edit Library</button>\n  </>\n  :\n  null\n:\nnull\n}\n\n\n\n{\n  addForm?\n  <div className='Library_Add_Book'>\n  <NewLibraryBook addBook={addBook} username={library.username} title={'title'}/>\n  <button type=\"button\" onClick={()=>setAddForm(false)} name=\"button\">Cancle</button>\n  </div>\n  :null\n}\n\n\n  </div>\n}\nexport default Library;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}